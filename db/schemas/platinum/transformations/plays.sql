
with play as
    (
    select *
    from baseball_aluminum.plays
    where play_outcome_play_id is not null
    )

MERGE INTO baseball_platinum.plays  target
USING play as source
ON source.about_game_id = target.about_game_id
       AND source.play_outcome_play_id = target.play_outcome_play_id
WHEN MATCHED THEN
    UPDATE SET result_rbi = source.result_rbi,
               updated_by = 'db',
               date_updated = current_timestamp
WHEN NOT MATCHED THEN
    INSERT (about_game_id, about_at_bat_index, about_half_inning, about_is_top_inning, about_inning, about_start_time, about_end_time, about_is_complete, about_is_scoring_play, about_has_review, about_has_out, about_captivating_index, matchup_batter_id, matchup_bat_side_code, matchup_pitcher_id, matchup_pitch_hand_code, matchup_post_on_first_id, matchup_post_on_second_id, matchup_post_on_third_id, matchup_batter_hot_cold_zones, matchup_pitcher_hot_cold_zones, matchup_splits_batter, matchup_splits_pitcher, matchup_splits_men_on_base, result_type, result_event, result_event_type, result_rbi, result_away_score, result_home_score, runners, play_outcome_details_call_code, play_outcome_code, play_outcome_ball_color, play_outcome_trail_color, play_outcome_is_in_play, play_outcome_is_strike, play_outcome_is_ball, play_outcome_type_code, play_outcome_type_description, play_outcome_is_out, play_outcome_has_review, play_outcome_count_balls, play_outcome_count_strikes, play_outcome_count_outs, play_outcome_pitch_data_start_speed, play_outcome_pitch_data_end_speed, play_outcome_pitch_data_strike_zone_top, play_outcome_pitch_data_strike_zone_bottom, play_outcome_pitch_data_coordinates_ay, play_outcome_pitch_data_coordinates_az, play_outcome_pitch_data_coordinates_pfxx, play_outcome_pitch_data_coordinates_pfxz, play_outcome_pitch_data_coordinates_px, play_outcome_pitch_data_coordinates_pz, play_outcome_pitch_data_coordinates_vx0, play_outcome_pitch_data_coordinates_vy0, play_outcome_pitch_data_coordinates_vz0, play_outcome_pitch_data_coordinates_x, play_outcome_pitch_data_coordinates_y, play_outcome_pitch_data_coordinates_x0, play_outcome_pitch_data_coordinates_y0, play_outcome_pitch_data_coordinates_z0, play_outcome_pitch_data_coordinates_ax, play_outcome_pitch_data_breaks_break_angle, play_outcome_pitch_data_breaks_break_length, play_outcome_pitch_data_breaks_break_y, play_outcome_pitch_data_breaks_break_vertical, play_outcome_pitch_data_breaks_break_vertical_induced, play_outcome_pitch_data_breaks_break_horizontal, play_outcome_pitch_data_breaks_spin_rate, play_outcome_pitch_data_breaks_spin_direction, play_outcome_pitch_data_zone, play_outcome_pitch_data_type_confidence, play_outcome_pitch_data_plate_time, play_outcome_pitch_data_extension, play_outcome_hit_data_launch_speed, play_outcome_hit_data_launch_angle, play_outcome_hit_data_total_distance, play_outcome_hit_data_trajectory, play_outcome_hit_data_hardness, play_outcome_hit_data_location, play_outcome_hit_data_coordinates_coordx, play_outcome_hit_data_coordinates_coordy, play_outcome_index, play_outcome_play_id, play_outcome_pitch_number, play_outcome_start_time, play_outcome_end_time, play_outcome_is_pitch, play_outcome_type, date_loaded, loaded_by, date_updated, updated_by)
    VALUES (about_game_id, about_at_bat_index, about_half_inning, about_is_top_inning, about_inning, about_start_time, about_end_time, about_is_complete, about_is_scoring_play, about_has_review, about_has_out, about_captivating_index, matchup_batter_id, matchup_bat_side_code, matchup_pitcher_id, matchup_pitch_hand_code, matchup_post_on_first_id, matchup_post_on_second_id, matchup_post_on_third_id, matchup_batter_hot_cold_zones, matchup_pitcher_hot_cold_zones, matchup_splits_batter, matchup_splits_pitcher, matchup_splits_men_on_base, result_type, result_event, result_event_type, result_rbi, result_away_score, result_home_score, runners, play_outcome_details_call_code, play_outcome_code, play_outcome_ball_color, play_outcome_trail_color, play_outcome_is_in_play, play_outcome_is_strike, play_outcome_is_ball, play_outcome_type_code, play_outcome_type_description, play_outcome_is_out, play_outcome_has_review, play_outcome_count_balls, play_outcome_count_strikes, play_outcome_count_outs, play_outcome_pitch_data_start_speed, play_outcome_pitch_data_end_speed, play_outcome_pitch_data_strike_zone_top, play_outcome_pitch_data_strike_zone_bottom, play_outcome_pitch_data_coordinates_ay, play_outcome_pitch_data_coordinates_az, play_outcome_pitch_data_coordinates_pfxx, play_outcome_pitch_data_coordinates_pfxz, play_outcome_pitch_data_coordinates_px, play_outcome_pitch_data_coordinates_pz, play_outcome_pitch_data_coordinates_vx0, play_outcome_pitch_data_coordinates_vy0, play_outcome_pitch_data_coordinates_vz0, play_outcome_pitch_data_coordinates_x, play_outcome_pitch_data_coordinates_y, play_outcome_pitch_data_coordinates_x0, play_outcome_pitch_data_coordinates_y0, play_outcome_pitch_data_coordinates_z0, play_outcome_pitch_data_coordinates_ax, play_outcome_pitch_data_breaks_break_angle, play_outcome_pitch_data_breaks_break_length, play_outcome_pitch_data_breaks_break_y, play_outcome_pitch_data_breaks_break_vertical, play_outcome_pitch_data_breaks_break_vertical_induced, play_outcome_pitch_data_breaks_break_horizontal, play_outcome_pitch_data_breaks_spin_rate, play_outcome_pitch_data_breaks_spin_direction, play_outcome_pitch_data_zone, play_outcome_pitch_data_type_confidence, play_outcome_pitch_data_plate_time, play_outcome_pitch_data_extension, play_outcome_hit_data_launch_speed, play_outcome_hit_data_launch_angle, play_outcome_hit_data_total_distance, play_outcome_hit_data_trajectory, play_outcome_hit_data_hardness, play_outcome_hit_data_location, play_outcome_hit_data_coordinates_coordx, play_outcome_hit_data_coordinates_coordy, play_outcome_index, play_outcome_play_id, play_outcome_pitch_number, play_outcome_start_time, play_outcome_end_time, play_outcome_is_pitch, play_outcome_type, date_loaded, loaded_by,CURRENT_TIMESTAMP, 'db')
